THM-SIMPLE CTF

we'll start wit nmap scan
sudo nmap -A -T4 --min-rate=5000 -v -p- 10.10.29.19 -oN nmap.txt


so we found 3 ports
port 21
port 80
port 2222  ssh

ftp anonymous login is allowed on port 21,lets check it out
seems the ftp is empty
lets check the next port

nothing seem interesting on the webpage too, let's bruteforce for directories and see what we cam find
gobuster dir -u http://10.10.107.95 -w /usr/share/wordlists/dirbuster

found a directory /simple
going to this webpage, found a cms with a vulnerable version 2.2.8 that is vulnerable to sqli
searching google for the exploit and we found a cve poc for it.
lets try to exploit this webpage using our sarched payload
./46635.py -u http://10.10.173.166/simple -c -w
/usr/share/seclists/Passwords/Common-Credentials/best110.txt

it took me a while to be able to run the exploit but I finally realize that I had to add parenteses to some lines in the exploit code before it can run

after running our exploit we found a username= mitch
and an email = admin@admin.com
and the salt for password found: 1dac0d92e9fa6bb2
and a hash that looks like md5  0c01f4468bd75d7a84c7eb73846e8d96$
for some reasons we still couldn't crack the paword with our payload, still some error in the code

lets try to use hashcat to crack the salt and hash

hashcat -a 0 -m 20 salt-file.txt wordlist
-a = attack mode
-m = module which is 20 which allows us to combine the salt n hash
module 20 didnt work, now we are trying module 10

still couldn't get the pass.
since we have a username, let's bruteforce the ssh pass with hydra or ssb

so i found a faster shell bruteforcer ssb on github
download the binary file .tr.gz
tar xvzf ssb.tar.gz
chmod +x ssb
now lets bruteforce ssh
./ssb -p 2222 -w=wordlist mitch@10.10.28.134

finally we got our pasword as secret

NB; the port and wordlist must always come before the user and hostname for ./ssb to run

now lets login to ssh

we are in as mitch
lets stabilize our shell

using sudo -l to find where we can run sudo privileges, we found vim
searching through gtfobins, we found a vim exploit to excalate our privilge.

and we are root
cat /root/root.txt to get our root flag
W3ll d0n3. You made it!

and that's all